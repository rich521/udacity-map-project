function openNav(){nav?(document.getElementById("mySidenav").style.width="275px",document.getElementById("nav-button").style.marginLeft="275px",nav=!1):(document.getElementById("mySidenav").style.width="0",document.getElementById("nav-button").style.marginLeft="0",nav=!0)}var initialPlaces=[{name:"Big Ben",position:{lat:51.49984,lng:-.124663}},{name:"Buckingham Palace",position:{lat:51.501009,lng:-.141588}},{name:"Kensington Palace",position:{lat:51.504894,lng:-.18813}},{name:"Madame Tussauds London",position:{lat:51.522965,lng:-.155051}},{name:"London Bridge",position:{lat:51.508245,lng:-.0877}},{name:"London Eye",position:{lat:51.50282,lng:-.119252}},{name:"Royal Opera House",position:{lat:51.513283,lng:-.123433}},{name:"Sadler's Wells Theatre",position:{lat:51.529409,lng:-.106248}},{name:"Somerset House",position:{lat:51.510732,lng:-.116938}},{name:"St Paul's Cathedral",position:{lat:51.514274,lng:-.098992}},{name:"The British Library",position:{lat:51.529985,lng:-.127014}},{name:"Tower of London",position:{lat:51.508112,lng:-.075949}}],map,markers=[],infowindow,state=!1,iconBase="img/marker.svg",initMap=function(){function e(e){setTimeout(function(){var n=new google.maps.Marker({position:new google.maps.LatLng(initialPlaces[e].position),map:map,title:initialPlaces[e].name,animation:google.maps.Animation.DROP,icon:iconBase});google.maps.event.addListener(n,"click",function(e,n){return function(){openWindow(e,initialPlaces[n].name)}}(n,e)),markers.push(n)},0*e,e),e===initialPlaces.length-1&&(state=!0)}var n=new google.maps.LatLng(51.505,-.134663);map=new google.maps.Map(document.getElementById("map"),{zoom:13,center:n,disableDefaultUI:!0});var i=[{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]}];map.setOptions({styles:i}),infowindow=new google.maps.InfoWindow;for(var t=0;t<initialPlaces.length;t++)e(t);google.maps.event.addDomListenerOnce(map,"idle",function(){google.maps.event.addDomListener(window,"resize",function(){map.setCenter(n)})})},openWindow=function(e,n){function i(){infowindow.setContent('<div id="infoWindow"><h4>'+n+'</h4><div id="loading"></div></div>'),infowindow.open(map,e),e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},750)}function t(){infowindow.setContent('<div id="infoWindow"><h4>'+n+"</h4>"+a+'<a href="'+o+'" target="_blank">source: \'Flickr images\'</p></div>')}var a,o,s="http://api.flickr.com/services/feeds/photos_public.gne?tags="+n+"&tagmode=any&format=json&jsoncallback=?",l=setTimeout(function(){infowindow.setContent('<div id="infoWindow"><h4>'+n+"</h4><h6>Failed to load Flickr image</h6></div>")},4e3);$.ajax({url:s,dataType:"jsonp",success:function(e){o=e.items[0].media.m,a='<div><img src="'+o+'" alt="Image Source" /></div>',t(),clearTimeout(l)}}),i()},filterMarker=function(e){for(var n=0;n<e.length;n++)for(var i=0;i<markers.length;i++)markers[i].title===e[n].name&&markers[i].setVisible(!0)},Place=function(e){this.name=ko.observable(e.name)},ViewModel=function(){var e=this,n=ko.observableArray(initialPlaces),i=n(),t=[];this.placeList=ko.observableArray([]),initialPlaces.forEach(function(n){e.placeList.push(new Place(n)),t.push(n.name)}),this.currentPlace=ko.observable(this.placeList()[0]),this.clickPlace=function(n){e.currentPlace(n),openWindow(markers[t.indexOf(n.name)],n.name)},e.filterText=ko.observable("");for(var a=0;a<i.length;a++){var o="search_content",s=i[a];s.content=">";for(var l in s)(s.hasOwnProperty(l)||l!==o||"string"==typeof s[l])&&(s.content+=s[l])}e.filteredPlaces=ko.computed(function(){var n,t;t=e.filterText(),n=new RegExp(t,"gi");var a=ko.utils.arrayFilter(i,function(e){return t.length?e.content.match(n):!0});if(state){for(var o=0;o<markers.length;o++)infowindow.close(),markers[o].setVisible(!1);filterMarker(a)}return a},e)},nav=!0;ko.applyBindings(new ViewModel);